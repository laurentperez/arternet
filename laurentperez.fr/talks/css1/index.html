<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>laurentperez.fr::talks::houdini</title>
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css">
		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">
		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
		<style>
			.reveal section p {
			font-size: 0.8em !important;
			}
			.reveal section h2 {
			font-size: 1.2em !important;
			}
			.reveal section h3 {
			font-size: 1em !important;
			}
			.reveal section img {
			margin:0 !important;
			border: none !important;
			}
			.reveal section blockquote {
			font-size: 0.5em !important;
			}
			.reveal section ul li {
			font-size: 0.6em !important;
			}
			.reveal section ol li {
			font-size: 0.6em !important;
			}
			</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				
				<section>
					<p>Meetup AFUP / Web Front</p>
					<p>"Les CSS envo√ªt√©es par la magie d'Houdini"</p>
					<p>Dessin et animations nouvelle g√©n√©ration, et plus encore</p>
					<p><img src="awe.png" alt=""></p>
					<p><img src="mth.jpg" width="30px"/></p>
					<small>@laurentperez / Slack Comm MPL</small>
				</section>
				<!--

					Le moteur CSS envo√ªt√© par la magie d'Houdini
					Pour du dessin et animations nouvelle g√©n√©ration... et plus encore

					Le meetup AFUP est notre h√¥te √† titre exceptionnel pour ce talk 
					enti√®rement d√©di√© frontend Web/CSS, avec un peu de JS

					Houdini, issu de travaux de Google/Apple/Mozilla, pousse les portes du moteur CSS et les ouvre encore davantage aux d√©veloppeurs.ses frontend mais √©galement
					aux cr√©as/UI, avec √† la clef un jeu √©tendu de possibilit√©s de dessin, d'animation, de propri√©t√©s, 
					et m√™me de layout.

					Le talk vous emm√®ne en balade explorer ces nouvelles possibilit√©s, et les besoins auxquelles elles r√©pondent.
					Avec d√©mos de cas d'usages r√©els √† la cl√© !

				-->
				<section>
					<h2>Nos h√¥tes</h2>
					<p><img src="invivo.png" width="200px" alt="">&nbsp;<img src="afup.png" width="200px" alt=""></p>
					<p>... votre speaker</p>
					<p>... et vous !</p>
				</section>

			<section>
				<h2>Toi, public</h2>
				<p>Qui fait du front/UI/animation/print/vid√©o ?</p>
				<p class="fragment fade-up">Ratio natif iOS/Android/Win (hors WebViews) &amp; web pur ?</p>
				<p class="fragment fade-up">Exemples de derni√®res demandes clientes ou cr√©as complexes ?</p>
			</section>

			<section>
				<h2>CSS, je t'üíñ moi non plus</h2>
				<!-- üòø -->
				<p><img src="gsb.png" width="400px" alt=""></p>
				<p>C'est assez vrai. floats, !important, z-index, negative margins, positions, (r)em/px ...</p>
				<p><small>Des libert√©s laiss√©es aux fabricants de navigateurs, specs trop souples = doutes = bugs ou mues (cf -ms-grid)<br>
				Travaux des groupes W3C (Open Web) et WhatWG (fabricants) s√©par√©s jusqu'en... Mai 2019</small></p>
				<p class="fragment fade-up">C'est le pass√©. Ca va -globalement- beaucoup mieux, malgr√© quelques tensions entre Moz et Google, li√©es privacy</p>
				<p class="fragment fade-up">Membres clef du CSSWG @twitter, YT : Rachel Andrew (Smashing), Lea Verou (MIT), Tab Atkins (Google), Jen Simmons (Moz)</p>
			</section>

			<section>
				<h2>‚ú® CSS Houdini ‚ú®</h2>
				<p class="fragment fade-up">ouvre davantage le moteur CSS via JS</p>
				<p class="fragment fade-up">on a un acc√®s au plus proche de l'interne du moteur</p>
				<p class="fragment fade-up">on peut y cr√©er nos propri√©t√©s, peinture/clip, animation, layout personnels : on <em>√©tend</em> le moteur</p>
				<p class="fragment fade-up">pour nos propres effets graphiques</p>
				<p class="fragment fade-up">travail commenc√© fin 2015</p>
				<p class="fragment fade-up">pour les devs, pour les cr√©as</p>
				<p  class="fragment fade-up">suite du travail apr√®s WebComponents, WebWorkers ... et Web Animations API</p>
			</section>

			<section>
				<h2>ü§î ... Une solution √† la recherche d'un probl√®me ? ü§î</h2>
				<p>C'est un acc√®s "boite √† outils cr√©a" sur le moteur CSS. OK ...</p>
				<p class="fragment fade-up"><blockquote>" Like 10000 spoons when all you need is a knife ". Ironic don't you think ?</blockquote></p>
				<p class="fragment fade-up">Ca te donne de quoi construire ton couteau si tu n'en avais pas</p>
				<p class="fragment fade-up">Si tu en avais, √ßa te permet de le polir, l'am√©liorer, ou faire une alternative, variation... en faire un pinceau √† poils doux au lieu de dents, prototyper une id√©e</p>
			</section>

			<section>
				<h2>With great power...</h2>
				<p>Houdini = Extension du moteur CSS, outillage sans limites ou presque* : c'est pas open bar total, mais tu peux faire ton propre cocktail</p>
				<p><img src="bond.png" width="400px" alt=""></p>
				<pre class="fragment fade-up"><code class="css">
.vesper {
	--gin:6; --vodka:1.5; --lillet:0.75; --lemon:1;
	background:paint(shaken) !important; /* not stirred */
	display:layout(martiniglass);
}
				</code>
				</pre>
			</section>

			<section>
				<h2>Qui te donne - ou pas - le couteau ?</h2>
				<p class="fragment fade-up">Les fabricants de navigateurs, et de librairies - toi compris !</p>
				<p class="fragment fade-up">Houdini, la reine des neiges dans ton navigateur ‚ùÑÔ∏è</p>
				<p class="fragment fade-up">Lib√©r√©(e), d√©livr√©(e) de limites du moteur, des librairies tierces. <em>Tu n'attends plus ta fonction CSS : tu peux l'√©crire, la partager dans un cadre standard Web, √©tendre une fonction existante du moteur</em></p>
				<p class="fragment fade-up">... √ßa t'emp√™che pas de commit sur OSS si tu sais/peux/veux le faire, ou trouver des compromis cr√©as (ex: chifoumi, alcool)</p>
				<small class="fragment fade-up">On cite un hit musical, une princesse Disney, une arme blanche, de l'OSS, 2 des GAFA. Joyeux bordel Tarantinesque. Tout va bien</small>
			</section>

			<section>
				<h2>Buts et acteurs</h2>
				<p  class="fragment fade-up">Ouvrir les portes de la "magie" CSS et pouvoir √©tendre le moteur sans attendre les fabricants ou ticket les librairies tierces</p>
				<small  class="fragment fade-up">Diminuer l'interaction JS √† base de addClass/el.style ou les hacks type translate3D(0,0,0) et manipulations de DOM et CSSOM douteuses</small>
				<p  class="fragment fade-up">S√©parer la logique dessin/animation/layout (JS) et son style (CSS)</p>
				<p  class="fragment fade-up">Faciliter du rendu √† 60fps fluide hors thread principale</p>
				<p>Task force Google, Mozilla, Apple. R√©elle volont√©, par et pour des devs/UI</p>
				<small  class="fragment fade-up">hacks JS = parce qu'on n'a pas parfois le choix. Coucou Samsung, certains iOS</small>
			</section>

			<section>
				<p>Le DFO et son navigateur web</p>
				<p><img src="pai.jpg" width="600px" alt=""></p>
				<p>QCM : o√π est ton client, ton/ta cr√©a UI UX, ton navigateur, ton budget, ta deadline, ton/ta coll√®gue super dou√©(e) qui t'aide en front, jQuery, ton DOM, ta CSS ... toi ?</p>
			</section>

			<section>
				<p>Dans une maquette, 70% est "facile" - relatif √† l'exp√©rience de chacun(e). Hors WebGL, autre domaine</p>
				<p>C'est quand le moteur ne te donne pas les autres 30% que la recherche commence (toi, tes coll√®gues, google, stackoverflow, ...)</p>
				<p>Houdini = moins de gal√®res, moins de "on peut pas le faire en CSS / pur web" : tu <em>√©tends pour ton besoin</em> le moteur</p>
				<p>Houdini + Flex/Grid + BEM/SASS/LeSS = üåà</p>
				<p class="fragment fade-up">nb : ce n'est pas un rempla√ßant √† WebGL. C'est <a href="https://en.wikipedia.org/wiki/WebGPU">WebGPU</a> qui remplacera WebGL</p>
			</section>

			<section>
				<p>Houdini peu difficile, ni obscur. On a 5 nouvelles possibilit√©s sur des bases CSS / Dessin / Animation</p>
				<p><img src="posabs.png" width="400px" alt=""></p>
				<small>"CSS vertical align" sur Google : Environ 10‚ÄØ600‚ÄØ000 r√©sultats</small>
			</section>

			<section>
				<p>Division en 5 nouvelles grandes APIs correspondantes √† 5 besoins</p>
				<p><a href="https://github.com/w3c/css-houdini-drafts">https://github.com/w3c/css-houdini-drafts</a> (repo des specs)</p>
				<p><a href="https://drafts.css-houdini.org">https://drafts.css-houdini.org</a> (specs)</p>
				<ul>
					<li class="fragment fade-up">CSSOM API (CAPI) : nouveaux objets CSS</li>
					<li class="fragment fade-up">Properties/Values API (PVAPI) : properties typ√©es m√©tier</li>
					<li class="fragment fade-up">Paint API (PAPI) : dessin perso</li>
					<li class="fragment fade-up">Worklet Animation API (WAPI ...sur WAAPI) : animations on drugs</li>
					<li class="fragment fade-up">Layout API (LAPI) : layout perso</li>
					<li class="fragment fade-up">... 6e optionnelle, Font Metrics API (FMAPI) *</li>
					</ul>
				<small class="fragment fade-up">* = pas encore d'impl√©mentation, bonus pour typo</small>
			</section>

			<section>
				<h2>Oui, mais le support ?</h2>
				<p><a href="https://www.chromestatus.com/features#houdini">https://www.chromestatus.com/features#houdini</a> </p>
				<p><a href="https://ishoudinireadyyet.com">https://ishoudinireadyyet.com</a> </p>
				<ul>
					<li>CSSOM : livr√© Chrome, ii FF, in dev SF</li>
					<li>Properties Values API : in dev 90% Chrome/SF, in dev FF</li>
					<li>Paint API : livr√© Chrome, ii FF, in dev SF</li>
					<li>Worklet Animation API : in dev 80% Chrome, uc SF</li>
					<li>Layout API : in dev 70% Chrome, uc FF/SF</li>
					<li>Font Metrics API : rien, uniquement les specs</li>
				</ul>
				<small>uc: Consid√©r√©, ii: Intent to Implement (signal travail assign√©), in dev: En cours : dans Safary TP, Chrome Canary, FF Nightly</small>
				<p class="fragment fade-up"><small>Important : WAAPI √† 100% dans <a href="https://caniuse.com/#search=web%20anima">Safari / iOS13</a> et <a href="https://birtles.github.io/areweanimatedyet/">FF Nightly</a>, √† 80% Chromium (playback .pause(),.reverse() pas fini)</small></p>

			</section>

			<section>
				<p><img src="bicons.png" width="200px" alt=""></p>
				<p>Chromium (Blink) et Safari (WebKit) devant</p>
				<p>Firefox (Servo) derri√®re, IE va utiliser Blink</p>
				<p >La Team IE Edge va verser le meilleur de Edge dans Blink (Reddit aMa 06/19), r√©ouvrir <a href="https://www.reddit.com/r/IAmA/comments/c094uf/hi_reddit_were_the_team_behind_microsoft_edge_and/">des API bloqu√©es contre adblockers</a></p>
				<p><blockquote class="fragment fade-up">"We're still evaluating some of the latest changes here in Chromium(...). To be clear, we will not artificially restrict ad blocking for business reasons related to advertising."</blockquote></p>
				<p><blockquote class="fragment fade-up">Finally, we occasionally hear requests for a built in ad blocking experiences in Edge. For most users, we find that extensions (combined with strong defaults around tracking prevention) are the best option (...) but we absolutely want to hear from you if you think this should be built in.</blockquote></p>
			</section>

			<section>
				<p>Les 5 API ne sont pas -encore- disponibles partout</p>
				<p>donc : CSS @supports(xxx){....} + JS if('xxx' in CSS)</p>
				<p>√ßa fait quelques ann√©es que les prefix -webkit -moz -ms ont √©t√© abandonn√©s pour toute nouvelle fonction</p>
				<p>√† la place, flags explicites √† cocher sous 'Experimental features'</p>
				<p>... et Progressive Enhancement, toujours penser fallback</p>
			</section>

			<section>
				<p>Que Firefox soit en "retard" <em>n'est pas une mauvaise chose</em></p>
				<p><img src="rp.png" alt=""></p>
				<p class="fragment fade-up">D√ª au switch de Gecko vers Servo √† partir de 2017, 2 moteurs</p>
				<p class="fragment fade-up">On veut de la diversit√© dans les moteurs de rendu, Servo est top</p>
				<p class="fragment fade-up">Pas de One Chrome to rule them all... Apple interdit autre moteur que WebKit</p>
				<small>FF Worklet a boug√© &lt; 1 mois : <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1315239">https://bugzilla.mozilla.org/show_bug.cgi?id=1315239</a></small>
				<small>en Q3 2019 tout Houdini marqu√© en Enhancement Prio 3, les tickets dataient de 2017, la Worklet est un pilier des API</small>
			</section>
			
			<section>
				<h2>Les nouvelles API au menu</h2>
				<p>Nouveaux objets CSS et propri√©t√©s perso typ√©es</p>
				<p>Nouveaux objets JS Worklets pour :</p>
				<p>Dessin, peinture, animation, layout</p>
				<p>... fontes en dessert/caf√© (tr√®s l√©ger)</p>
			</section>
			
			<section>
				<h2>CSSOM API</h2>
				<p>Fini la concat√©nation et les typos, et enfin le try/catch</p>
				<p>Nouveaux objets CSS* et .attributesStyleMap/.computedStyleMap</p>
				<pre class="fragment fade-up"><code class="css">
el.attributeStyleMap.set('opacity', CSS.number(0.3));
el.attributeStyleMap.has('opacity');
el.computedStyleMap().get('opacity').value
// ex getComputedStyle(el).xxx
el.attributeStyleMap.delete('opacity')
el.attributeStyleMap.clear();
CSS.vw(100); CSS.px(42); CSS.angle(90deg);
CSS.percent(10); CSS.ms(300);
new CSSTranslate(CSS.px(10), CSS.px(10))
// translate(10px, 10px)
new CSSStyleValue.parse('transform', 'translte3d(...)');
// typo throw
				</code></pre>
			</section>

			<section>
				<h2>Ce nouvel objet <em>CSS</em></h2>
				<p>est la pierre fondatrice d'Houdini</p>
				<pre class="fragment fade-up"><code class="css">
CSS.registerProperty(...);
CSS.paintWorklet.addModule(...);
CSS.animationWorklet.addModule(...);
CSS.layoutWorklet.addModule(...);
				</code>
</pre>	
<p class="fragment fade-up">et les <em>Worklets</em> ses assistant(e)s</p>
<p class="fragment fade-up">... une AudioWorklet est dans Firefox et Chrome  - hors Houdini</p>
			</section>

			<section>
				<p>Pour toutes les d&eacute;mos qui vont suivre </p>
				<p>Activation des flags beta Web/CSS requise</p>
				<p><small>Chrome Canary --enable-blink-features=GroupEffect
					<br>
					Safari Technology Preview
				</small></p>
				<img src="cflags.png" width="400px" alt="">
				<img src="sflags.png" width="400px" alt="">
			</section>
			<section>
				<h2>üîë Properties/Values API üîë</h2>
				<p >Enfin (!) du typage dans des variables CSS perso</p>
				<small>... on rappelle BEM/SASS/Less pour une structure de classes maintenable</small>
				<p class="fragment fade-up">11 types support√©s : length, number, %, color, image, url(), integer, angle, time, dpi, transform</p>
				<pre class="fragment fade-up"><code class="css">
CSS.registerProperty({
 name: '--sky', /* stp change un peu le ciel du header ? */
 syntax: '&lt;color&gt;', /* son type pour JS (objet Color rgba) */
 inherits: true, /* propag√©e vers le bas dans le DOM tree */
 initialValue: 'vanilla', /* son default */
});</code></pre>
				<small>SVP ne pas inventer des horreurs lexicales comme --couleur=color, --largeur=width</small>
				<small>inherits : false par d√©faut pour pas recalculer le CSSOM tree si pas besoin</small>
				<p><a href="../cssp">demo</a></p>
			</section>

			<section><h2>üé® Paint API üé®</h2>
				<p>Dessin libre avec <em>background:paint('perso');</em></p>
				<p><em>CSS.paintWorklet.addModule('stars.js');</em></p>
				<p>Introduction de <em>PaintWorklet</em> : analogie avec les <em>Workers</em> JS</p>
				<p class="fragment fade-up">Une <em>Worklet</em> est un JS de dessin dormant, en t√¢che de fond</p>
				<p class="fragment fade-up">But : qu'elle ne tourne pas dans la main thread (main JS sur main sans rAf = √ßa rame) mais dans une autre thread</p>
				<p class="fragment fade-up">La Paint API te donne un <em>Canvas</em> sans acc√®s au DOM</p>
				<small class="fragment fade-up">donc oui le 31/10 tu peux faire background:paint(üéÉ);</small>
				<p><a href="../cssp">demo (voir les 2 threads + FPS)</a></p>
			</section>

			<section>
				<h2>Dessin dormant ?</h2>
				<p>La Worklet est dormante et se r√©veille quand :</p>
				<p class="fragment fade-up">Une des propri√©t√©s CSS mapp√©es change (ex:sky,ranking)</p>
				<p class="fragment fade-up">La g√©om√©trie de l'√©l√©ment peint change (ex:resize... responsive)</p>
				<p class="fragment fade-up">La timeline bouge (ex:scroll, demo plus loin)</p>
				<p class="fragment fade-up">Une Worklet r√©veill√©e va dessiner √† <em>chaque frame, donc 60 fois/seconde</em> : ton budget fluide est de 16ms</p>
				<p class="fragment fade-up">C'est un WebWorker en plus l√©ger, c√¢bl√© directement sur le moteur CSS. Proche d'un layer Photoshop, effect Premiere, After Effect</p>
			</section>

			<section>
				<h2>S√©curit√©</h2>
				<ul>
					<li>Aucun acc√®s au DOM et les Properties sont readonly. Le Canvas est √©tanche. Si besoin de DOM, faire un Canvas classique sans Paint API</li>
					<li class="fragment fade-up">Car tu n'as pas sp√©cialement envie qu'un Canvas charg√© <em>depuis JS/CSS externe</em> puisse lire repeindre ou masquer des √©l√©ments de ta page</li>
					<li class="fragment fade-up">exemple : redessiner champ input de saisie de CB avec un message pour contacter la "banque" avec n¬∞ surtax√©</li>
					<li>c'est un <em>PaintRenderingContext2D</em> subset de <em>CanvasRenderingContext2D</em> : un Canvas restreint, uniquement d&eacute;di&eacute; √† du dessin</li>
				</ul>
				<img src="gifhack.gif" width="200px" style="border: none;" alt="">
			</section>

			<section>
				<p>11 Types trop simples ? Comment passer des complexes ?</p>
				<p class="fragment fade-up">exemple : un flux audio/vid√©o/ECU (data automobile)... = faire de la DataViz depuis une source riche, √† 60fps</p>
				<p class="fragment fade-up">solution (Juin 2019) : ajouter un type &lt;blob&gt;</p>
				<p><a href="https://github.com/w3c/css-houdini-drafts/issues/872">https://github.com/w3c/css-houdini-drafts/issues/872</a></p>
				<p class="fragment fade-up">... tu peux d√©j√† passer une property arbitraire non typ√©e fa√ßon</p>
					 <pre class="fragment fade-up"><code class="css">
--madata:'{foo:1,bar:2}';
/* c'est moche, mais tu peux...
en attendant postMessage (spoiler) */
					 </code></pre>
			</section>

			<section>
				<p>Skins : background:paint('488GT3'); background:paint('motec');</p>
				<pre class="fragment fade-up"><code class="css">
/* nos Properties CSS custom (ici, number)*/
--gear: 3; /* si pas set: initialValue, Motec 0 */
--speed: 81; 
--pos: 16;
--laptime: 7.28;
--rpm: 6000;
/* jauge rectangle en Ferrari, arc rectangles en Motec */
background-image:paint('compteur')
/* Worklet compteur.js : ta logique et plus ton style */
				</code></pre>
				<img src="488.jpeg" width="350px" alt="">
				<img src="motec.jpeg" width="350px" alt="">
			</section>

			<section>
					<h2>C'√©tait un peu norm√© cette peinture</h2>
					<p><img src="willh1.png" width="500px" alt=""></p>
					<p>... on va mettre un peu d'animation</p>
			</section>

			<section>
				<h2>üé¨ Worklet Animation API üé¨</h2>
				<p>Animations non blocking √† 60fps relatives √† une timeline libre
				... c'est assez fait pour le scroll, et √ßa le fait - tr√®s tr√®s - bien</p>
				<small class="fragment fade-up">qui a d√©j√† fait des parallaxes fluides ? des offsets / staggering ? Material/anime.JS ?</small>
				<p><em>CSS.animationWorklet.addModule('anim.js')</em></p>
				<p class="fragment fade-up">Un <em>Animator</em> de <em>KeyFrameEffects</em> sur une <em>timeline</em></p>
				<p class="fragment fade-up">Note : s√©quence/chor√©graphie √† faire √† la main. Un peu ballot, car <em>GroupEffect</em> dans la spec - mais cach√© par un flag pour le moment</p>
				<!--  --enable-blink-features=GroupEffect -->
				<p class="fragment fade-up"><a href="https://www.tesla.com/model3">Chor√©graphie chez un petit site web</a></p>
			</section>

			<section>
				<p>Encore une API d'animation ? D√©j√† 3</p>
				<small>... on a d√©j√† CSS transitions, CSS animations (@keyframes), Web Animations API (el.animate({...}).pause())</small>
				<p class="fragment fade-up">NON. La Worklet est une <em>extension</em> de WAAPI qui donne au <em>KeyframeEffect</em>, une <em>timeline</em> libre (dont une <em>ScrollTimeline</em>) et un √©tat optionel (stateful)</p>
				<p class="fragment fade-up">ex: se souvenir de l'√©tat pour le modifier/partager dans le temps, ou quand le moteur bouge la Worklet entre threads (kill and revive)</p>
				<p class="fragment fade-up">ex: acc√©l√©rer/distordre le temps (document.timeline relative)</p>
				<p><a href="../waapi">demo (+ question paint flashing + layer borders)</a></p>				
			</section>

			<section>
				<p>Pourquoi on a toujours du paint flashing ? - sur certains √©l√©ments</p>
				<p>Parce que j'ai modifi√© leur g√©om√©trie ou box shadow</p>
				<p class="fragment fade-up">Et ce sont des classiques qui d√©clenchent un repaint</p>
				<p class="fragment fade-up"><a href="https://csstriggers.com/">https://csstriggers.com/</a></p>
				<p class="fragment fade-up">Mais la Worklet n'est pas sur la Main thread : no UI jank si son JS rame, au pire c'est elle qui rame, pas toute l'interface</p>
				<small class="fragment fade-up">fini les hacks risqu√©s translate3d(0,0,0), la Worklet promeut l'√©l√©ment en Layer vers le Compositor</small>
			</section>

			<section>
				<p>‚öôÔ∏èÔ∏è Main thread, Layer, Compositor ? üñåÔ∏è</p>
				<p>Main thread : l√† o√π la UI vit (impact√©e par r√©seau, manips lourdes de DOM, CSS, JS lent, etc...)</p>
				<p>Layer : un navigateur range par calques, pour optimiser. cf Photoshop</p>
				<p>Compositor : le dernier √©l√©ment de la cha√Æne de rendu d'un navigateur, qui traite les pixels des calques (opacity, transform)</p>
				<p><small>Chargement page + ressources -> construction des arbres DOM, CSSOM -> Layout x/y -> mise en Layers -> Peinture + Compositing -> envoi des pixels vers la carte graphique</small></p>
				<p>spoiler : talk √† venir sur comment fonctionne un moteur de rendu </p>
			</section>

			<section>
				<p>La Worklet n'est <em>PAS sur la Compositor thread</em>, elle s'y <em><a href="https://chromium.googlesource.com/chromium/src/+/master/cc/paint/paint_worklet_layer_painter.h">defer</a></em></p>
				<p>Car si tu fais du bitcoin.js dans la Worklet, √ßa ralentirait le Compositing : seuls les <em>KeyframeEffects</em> l'int√©ressent</p>
				<p class="fragment fade-up">Elle va <em>au minimum</em> chercher √† performer comme <em>requestAnimationFrame</em> : √† 60fps, et b√©n√©ficie des optims du Compositor (ex: cache de frames, interpolation)</p>
				<p class="fragment fade-up">Si ton animate est trop souvent &gt; 16ms (1/60), le moteur peut t'offthread (kill and revive) ou throttle : un 30fps fluide est meilleur qu'un 60fps qui drop</p>
				<small class="fragment fade-up">60fps est une limite basse, l'iPad Pro est √† 120Hz, l'Oculus/Vive √† 90Hz. Chrome, IE et FF peuvent faire du 240Hz/480Hz sur des moniteurs usine. Apple discute de dalle 120Hz avec LG/Samsung pour <a href="https://twitter.com/UniverseIce/status/1152928927037308928?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1152928927037308928&ref_url=https%3A%2F%2Fwww.numerama.com%2Ftech%2F534917-les-iphone-de-2020-pourraient-etre-equipes-dun-ecran-120-hz-une-rumeur-realiste.html"> iPhone 2020</a></small>
				<br>
				<small class="fragment fade-up">Safari a une <a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/page/RenderingUpdateScheduler.cpp">option pour 60fps</a> et limite toutes les iframes sans interaction <a href="https://trac.webkit.org/changeset/215070/webkit">√† 30fps</a>, pour la batterie : un site web Vsync √† 120fps c'est beau mais chaud.</small>
			</section>

			<section>
				<p>Jouer avec le temps, animer des √©l√©ments corr√©l√©s</p>
				<p><img src="tars.jpg" alt=""></p>
				<small>Ne pas partir dans un trip sci-fi/math complexe avec doliprane : <em>la clef est *toujours* la timeline, si tu es perdu, regarde le temps ; d'o√π tu viens, o√π tu vas</em>.</small>
				<small>Penser en distance relative au temps : km/h, m/s, √† la Fl√®che du temps --&gt; (Eddington)</small>
				<small>... ou penser aux timelines de Macromedia Flash si tu pr√©f√®res les films d'horreur</small>
			</section>

			<section>
				<p>Flash et ses timelines</p>
				<img src="flash.gif" alt="">
				<p><small>no bashing, circa 2006 HTML/CSS ne valait rien pour une UI riche</small></p>
				<p><small>double budget pour faire un site pour IE et Netscape Navigator</small></p>
				<p><small>le Web est n&eacute; au CERN, pas dans une &eacute;cole d'art</small></p>
			</section>

			<section>
				<p>‚åõ Le temps peut √™tre bas√© sur une unit√© libre ‚åõ</p>
				<p class="fragment fade-up">On a vu le scroll, <a href="https://majido.github.io/houdini-samples/animation-worklet/touch-input/drag.html">touch d√©mo : le temps bas√© sur le deltaX d'un CSS Pointer Event (... ton doigt/stylo)</a></p>
				<p class="fragment fade-up"><img src="incep.png" alt=""></p>
				<p class="fragment fade-up">Le temps sur le bout de ton doigt. Si tu donnes NaN ou infinite... essaie ;)</p>
			</section>

			<section>
				<h2>Adobe &amp; AirBnb</h2>
				<p><a href="https://airbnb.design/lottie/">Lottie (AirBnb)</a></p>
				<p>Librairie pour Android/iOS/React Native... et web pur</p>
				<p>Importe les animations depuis Adobe After Effects</p>
				<p>La version web n'√©tait pas tr√®s performante, <a href="http://www.chromium.org/teams/animations/highlights-archive/april-2019-volume-ii">son moteur a √©t√© port√© sous Worklet</a></p>
				<p><a href="https://flackr.github.io/lottie-web/demo/bodymovin/">demo + animation panel</a></p>
			</section>

			<section>
				<p>Parfois on veut ranger des Effects ensemble</p>
				<p>Pour le moment (Ao√ªt), <em>GroupEffect</em>, groupe de <em>KeyFrameEffects</em> est cach√© (flag, ya plus de -prefix)</p>
				<p class="fragment fade-up">exemple : d√©marrer l'effet B quand le A est √† 50%, d√©marrer B, C, D en m√™me temps mais avec des offsets (= delay/parallaxe/stagger), pause() ou play() les effets en bloc</p>
				<small class="fragment fade-up">Travail important de Yi Gu sur la Chor√©graphie, Parallel, S√©quence et Stagger (√©chelon) pour am√©liorer la spec</small>
			</section>
			<section>
				<img src="pigeon.gif" alt="">
				<img src="corgi.gif" alt="">
				<p>les travaux de Yi sur <a href="https://github.com/yi-gu/group_effect">https://github.com/yi-gu/group_effect</a></p>
				<p>propose nouveaux types SequenceEffect, ParallelEffect, StaggerEffect en plus du GroupEffect</p>
				<p>Q1 2020. Yi est joignable et demandeur de retours</p>
				<small>Question √† Julian Garnier (anime.js) <a href>https://github.com/juliangarnier/anime/issues/602</a></small>
			</section>

			<section>
				<h2>üñºÔ∏è Layout API üñºÔ∏è</h2>
				<p>On a d√©j√† flex, column, grid...</p>
				<p class="fragment fade-up">OUI. Et Bootstrap aussi</p>
				<p class="fragment fade-up">et subgrid va arriver pour h√©riter des "rails" de grid (il est d√©j√† dans FF Nightly)</p>
				<p class="fragment fade-up">PVAPI, PAPI et WAPI ouvrent propri√©t√©s, dessin et animation... quid de la mise en page ?</p>
				<small class="fragment fade-up">Rappel : c'est Bloomberg qui a <a href="https://alistapart.com/article/the-story-of-css-grid-from-its-creators/">sponsoris√© grid dans WebKit/Blink</a> (impl√©ment√© par Igalia). Ils aiment bien les grilles, leur Terminal a 30 ans... pas ton navigateur evergreen</small>
				<p class="fragment fade-up"><img src="bloom.png" width="340px" alt=""></p>
			</section>

			<section>
				<h2>üñºÔ∏è Layout API üñºÔ∏è</h2>
				<p>Quand flex column ou grid ne te suffisent plus (oui oui)</p>
				<p class="fragment fade-up">c'est pour √©crire son propre display:layout('monlayoutperso');</p>
				<p><a href="https://houdini.glitch.me/layout">https://houdini.glitch.me/layout</a></p>
				<p class="fragment fade-up">Conteneur de <em>LayoutChild/Fragments</em> dans un <em>ParentLayout</em></p>
				<small class="fragment fade-up">Le <em>Parent</em> a des borders, paddings : les <em>Edges</em>. Entre ces <em>Edges</em>, on a des <em>Constraints</em>. Les <em>LayoutChild</em> sont dans ces <em>Constraints</em> et ont des <em>Fragments</em></small>
				<p class="fragment fade-up">La *clef* : chaque <em>Fragment</em> a un <em>inlineOffset/blockOffset</em> pour le positionner par rapport √† la box de son <em>Child</em>... et peut aussi porter son propre layout (!)</p>
				<p>C'est - proche - d'un position:relative; mais dynamique dans un <em>wireframe</em> nomm√©</p>
			</section>

			<section>
				<p>penser √† Tetris : une disposition de blocs dans un espace constraint</p>
				<p class="fragment fade-up">display:layout('L'); display:layout('4bar'); ‚ñõ ‚ñö ‚ñê</p>
				<small class="fragment fade-up">4bar est ici 4 Fragments empil√©s, L 3 et le 4e a un offset √† droite</small>
				<p class="fragment fade-up">Le calcul des blocs Fragments est non blocking _asynchrone_ par les moteurs next-gen (LayoutNG CR, WebRender FF) : le futur Fragment peut d√©pendre de calculs diff√©r√©s ou longs = ... Promise JS</p>
				<p class="fragment fade-up">Cas d'usage : architecture, UI norm√©s (affichage dash militaire/industriel/logiciel, presse √©crite, eBooks, ePub Comics, branding)</p>
				<small class="fragment fade-up">des utilisaturs.trices de QuarkXPress/InDesign pour du print ?</small>
				<p><a href="../cssp">demo coincoin</a></p>
			</section>

			<section>
				<h2>üî† Font Metrics API üî†</h2>
				<p>... seulement utilitaire, caus√©e par la Layout API :</p>
				<p>placer des blocs custom c'est cool mais : on a parfois besoin de g√©rer du texte/symboles dedans, le web est Universel, l'alphabet non...</p>
				<small class="fragment fade-up">ex : faire son propre line-breaking, conna√Ætre les tailles r√©elles des Lettrines, symboles math chimie ‚àë ‚àö ‚àû, des ligatures ≈í, √Ü, ŸÖÿ≠ÿ±ŸÉ, ’¥’∂, Ô¨ó, „Çü, et c√¶tera ‚Ä¶ </small>
				<p class="fragment fade-up">exposer seulement la Font ne suffit pas : il faut descendre au niveau du <em>glyphe</em> dessin√© par chaque navigateur, √† sa fa√ßon</p>
				<p class="fragment fade-up">la FMAPI donnera un objet JS FontMetrics des glyphes dessin√©s, utilitaire interne pour typographes et pros du print multi alphabets</p>
			</section>
				
			<section>
				<h2>D√©mo avanc√©es : Majido et Rocks</h2>
				<p>avec Chrome Canary, Safari Technology Preview ou Firefox Nightly (peu d'impl√©ment√©)</p>
				<p><a href="https://majido.github.io/houdini-samples/">https://majido.github.io</p>
				<p><a href="https://css-houdini.rocks">https://css-houdini.rocks</a></p>
				<p>notamment : QR generator, Trip App, Twitter, Inner Borders, Masonry, Random Bubble Masks</p>
			</section>

			<section>
				<h2>Pour suivre / plus loin</h2>
				<p><a href="https://github.com/w3c/css-houdini-drafts/wiki/Meeting-Planning-Pages">https://github.com/w3c/css-houdini-drafts/wiki/Meeting-Planning-Pages</a> (transcripts meetings trimestriels du CSSWG)</p>
				<p><a href="https://houdini.glitch.me">https://houdini.glitch.me</a> (r√©capitulatif illustr√©)</p>
				<p>Q2 2020, rapprochement de Paint API et Web Animations API :</p>
				<p>On peut imaginer un outil en ligne 100% web, gratuit et open source qui remplacerait Sketch/Adobe XD, 100% extensible car bas√© sur des standards web... next killer product ?</p>
				<p>Plus de "on peut pas le faire en CSS" : mais √ßa va demander des comp√©tences de dessin canvas2D et animation... FullFullStack ?</p>
			</section>

				<!--
				<section>Recap blogs wk/chome</section>
				<section>pwa</section>
				<section>preload srcset</section>
				-->


				

				<section>
					<h2>Merci</h2>
					<p><small>"√† la fin, c'est toujours l'Open Web qui gagne, √ßa prend juste du temps" - Yann</small></p>
					<p>Speakers wanted</p>
					<p>sur des sujets web front</p>
					<p>@laurentperez / Slack Comm MPL</p>
					<p><small>merci sp√©cial √† Charlotte<br>Chloe, Estelle, Julien(s)</small></p>
				</section>

			</div>
		</div>

		<script src="js/reveal.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				history:true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
		<script src="script.js"></script>
	</body>
</html>
