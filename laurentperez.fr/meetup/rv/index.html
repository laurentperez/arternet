<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>reveal.js</title>
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">
		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">
		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				
				<section>
					<h2>Meetup Frontend CSS/JS #1</h2>
					<p>MontpellierJS / Web Front/Privacy</p>
					<p><img src="awe.png" alt=""></p>
					<small>laurentperez.fr/talks/css1</small>
				</section>

				<section>
					<h2>Toi, public</h2>
					<p>Qui fait du front/UI/animation/print/TV ?</p>
					<p>Ratio natif iOS/Android (hors WebViews) &amp; web/print/vid√©o ?</p>
				</section>

				<section>
				<h2>‚ú® CSS Houdini ‚ú®</h2>
				<p class="fragment fade-up">tl;dr : pour un acc√®s direct au moteur CSS via JS</p>
				<p class="fragment fade-up">fini les hacks, on a un v√©ritable acc√®s au moteur</p>
				<p class="fragment fade-up">on peut cr√©er nos propri√©t√©s, peinture, animation, layout</p>
				<p class="fragment fade-up">travail commenc√© circa 2016</p>
				<p  class="fragment fade-up">suite logique du travail apr√®s WebComponents et ServiceWorkers</p>
				</section>

				<section>
					<h2>Motivations</h2>
					<p>Ouvrir les portes de la "magie" CSS et pouvoir √©tendre le moteur sans attendre les fabricants ou ticket les librairies tierces</p>
					<small>Arr√™ter les hacks JS √† base de addClass/el.style/translate3D(0,0,0)</small>
					<p>S√©parer logique (JS) et style (CSS)</p>
					<p>Garantir du rendu √† 60fps hors thread UI principale</p>
					
					<p>Task force Google, Mozilla, Apple</p>
					<small>hacks JS = parce qu'on n'a pas le choix</small>
				</section>

			<section>
					<p>Division en 6 grandes APIs</p>
					<p>https://github.com/w3c/css-houdini-drafts (repo des specs)</p>
					<p>https://drafts.css-houdini.org (specs)</p>
					<ul>
							<li class="fragment fade-up">CSSOM API (CAPI)</li>
							<li class="fragment fade-up">Properties/Values API (PVAPI)</li>
							<li class="fragment fade-up">Paint API (PAPI)</li>
							<li class="fragment fade-up">Web Animation API (WAAPI)</li>
							<li class="fragment fade-up">Layout API (LAPI) *</li>
							<li class="fragment fade-up">Font Metrics API (FMAPI) *</li>
						</ul>
						<small>* = pas encore d'impl√©mentation stable</small>
			</section>

			<section>
				<h2>Oui, mais le support ?</h2>
				<p>https://www.chromestatus.com/features#houdini</p>
				<p>https://ishoudinireadyyet.com</p>
				<ul>
					<li>CSSOM : shipped Chrome, ii FF, in dev SF</li>
					<li>Properties Values API : partial 90% Chrome/SF, in dev FF</li>
					<li>Paint API : shipped Chrome, ii FF, in dev SF</li>
					<li>Animation API : partial 80% Chrome (sans chor√©graphie, Q1 2020)</li>
					<li>Layout API : tr√®s partial Chrome, ii FF</li>
					<li>Font Metrics API : rien, uniquement les specs</li>
				</ul>
				<small>ii : Intent to Implement, in dev : partial, en cours : Safary Technology Preview, Chrome Canary</small>
			</section>
			
				
			<section>
				<h2>CSSOM API</h2>
				<small>passer vite</small>
				<p>Fini la concat√©nation et les typos, et enfin le try/catch</p>
				<p>Nouveaux objets CSS* et .attributesStyleMap/.computedStyleMap</p>
				<pre class="fragment fade-up"><code class="css">
el.attributeStyleMap.set('opacity', CSS.number(0.3));
el.attributeStyleMap.has('opacity');
el.computedStyleMap().get('opacity').value // ex getComputedStyle
el.attributeStyleMap.delete('opacity')
el.attributeStyleMap.clear();
CSS.vw('100'); CSS.px(42);
CSS.percent('10'); CSS.ms(300);
new CSSMathSum(CSS.vw(100), CSS.px(-10)) // "calc(100vw + -10px)"
new CSSStyleValue.parse('transform', 'translate4d(...)'); // throw
				</code></pre>
			</section>

			<section>
				<h2>Properties/Values API üîë</h2>
				<p>De la structure/typage dans des variables CSS custom</p>
				<small>... on rappelle BEM/SASS/Less pour une structure de classes maintenable</small>
				<p class="fragment fade-up">Types support√©s : length, number, %, color, image, url(), integer, angle, time, resolution, transform</p>
				<pre class="fragment fade-up"><code class="css">
CSS.registerProperty({
		name: '--sky',
		syntax: '&lt;color&gt;',
		inherits: true,
		initialValue: 'vanilla',
});</code></pre>
				<small>SVP ne pas r√©inventer des horreurs lexicales comme couleur=color, ni substituer aux data-* HTML5</small>
				<p>demo</p>
			</section>

			<section><h2>Paint API üé®</h2>
				<p>Dessin 2D personnalis√© avec <em>background:paint('foo');</em></p>
				<p>Introduction de <em>PaintWorklet</em> : analogie avec les <em>ServiceWorkers</em> pour le cache/offline/push notifs</p>
				<p class="fragment fade-up">Une <em>Worklet</em> est un JS short-lived, d√©pla√ßable entre threads au gr√© du moteur</p>
				<p class="fragment fade-up">But : qu'elle ne tourne pas dans la main thread (main JS sur thread UI sans rAf = lag) mais dans une autre thread</p>
				<p class="fragment fade-up">La Paint API donne un <em>Canvas</em> (2DContext) sans acc√®s au DOM</p>
				<small class="fragment fade-up">donc oui le 31/10 tu peux faire background:paint(üéÉ);</small>
				<p>demo</p>
			</section>

			<section>
				<h2>Quelques remarques</h2>
				<p>lire https://github.com/w3c/css-houdini-drafts/issues</p>
				<ul>
					<li>Par s√©curit√©, aucun acc√®s au DOM. Le Canvas est √©tanche. Si besoin de DOM, alors faire un Canvas classique</li>
					<li>Tu n'as pas sp√©cialement envie qu'un Canvas charg√© depuis JS/CSS <em>externe</em> puisse lire ou repeindre des √©l√©ments du DOM</li>
					<li>exemple : redessiner champ input de saisie de CB</li>
				</ul>
				<img src="gifhack.gif" width="200px" style="border: none;" alt="">
			</section>

			<section>
				<p>Values trop simples ? Comment passer des avanc√©es ?</p>
				<p>exemple : un stream audio/vid√©o/trading/ECU (data automobile) </p>
				<p>cheap solution (Juin 2019) : ajouter un type &lt;blob&gt;</p>
				<p>https://github.com/w3c/css-houdini-drafts/issues/872</p>
				<p>postMessage pour plus tard pour pas repasser la Value dans la main thread</p>
				<p>valable aussi pour AnimationWorklet :</p>
			</section>

			<section>
					<h2>Web Animations API üé¨</h2>
					<p>Animations non blocking √† 60fps relatives √† la timeline et au scroll
					... c'est surtout fait pour le scroll, et √ßa le fait bien</p>
					<small>qui a d√©j√† fait des parallaxes fluides ? des offsets / staggering ?</small>
					<p><em>AnimationWorklet/KeyFrameEffect</em>, avec √©tat pour se souvenir si le moteur stoppe la Worklet</p>
					<p>Limite actuelle : s√©quence/chor√©graphie √† faire √† la main. Un peu p√©nible, car <em>GroupEffect</em> dans la spec</p>
					<p>demo</p>
			</section>

			<section>
					<p>Sprints et roadmap : https://www.chromium.org/teams/animations/animation-objectives</p>
					<p>Pour le moment (Ao√ªt), <em>GroupEffect</em> = encha√Ænement de <em>>KeyFrameEffects</em> est d√©sactiv√©</p>
					<p>exemple : d√©marrer l'animation B quand la A est √† 50%, d√©marrer A, B, C, D en m√™me temps mais avec des offsets (= parallaxe/stagger)</p>
					<small>Travail important de Yi Gu sur la Chor√©graphie, S√©quence et Staggering pour am√©liorer la spec</small>
			</section>
			<section>
					<img src="pigeon.gif" alt="">
					<small>https://github.com/yi-gu/group_effect</small>
					<p>Q1 2020</p>
			</section>

			<section><h2>Layout API üñºÔ∏è</h2>
				<p>Quand flex ou grid ne suffisent plus (oui oui)</p>
				<p>tl;dr : √©crire son propre display:layout('monlayout');</p>
				<p>https://houdini.glitch.me/layout</p>
				<small>Rappel : c'est Bloomberg qui a sponsoris√© grid dans WebKit (Igalia)</small>
				<p>Conteneur de <em>LayoutChild/Fragments</em> dans un <em>ParentLayout</em></p>
				<small>Le <em>Parent</em> a des borders, paddings : les <em>Edges</em>. Entre les <em>Edges</em>, on a des <em>Constraints</em>. Les <em>LayoutChild</em> sont dans ces <em>Constraints</em> et ont des <em>Fragments</em></small>
				<p>La clef : chaque <em>Fragment</em> a un <em>inlineOffset/blockOffset</em> pour le positionner par rapport √† la box de son <em>Child</em></p>
				<p>C'est - en gros - du position:relative; dans un <em>wireframe</em></p>
			</section>

			<section>
				<p>c'est un peu plus compliqu√© que les autres API</p>
				<p>penser √† Tetris : une disposition de blocs dans un espace constraint</p>
				<p>display:layout('L'); display:layout('4bar'); ‚ñõ ‚ñö ‚ñê</p>
				<small>4bar est ici 4 Fragments empil√©s, L 3 et le 4e a un offset</small>
				<p>Les blocs Fragments sont _parall√©lisables_ pour les moteurs next-gen (LayoutNG CR, WebRender FF) : quand le 4bar rentre et 'flashe' un Tetris, 4 lignes sont √† effacer, et y-4 pour au dessus</p>
				<p>Cas d'usage : architecture, UI norm√©s (affichage dash militaire/voiture/avion, presse √©crite, eBooks, ePub Comics)</p>
				<small>des utilisaturs.trices de QuarkXPress/InDesign ?</small>
				<p>demo / illustrations</p>
			</section>

			<section>
				<h2>Font Metrics API üî†</h2>
				<p>... spec caus√©e par la Layout API :</p>
				<p>dessiner des blocs custom c'est cool mais : on a parfois besoin de g√©rer du texte dedans</p>
				<small>exemples : faire son propre line-breaking, conna√Ætre la baseline dans un Fragment, les tailles r√©elles des symboles math chimie, des ligatures ≈í, √Ü, ŸÖÿ≠ÿ±ŸÉ, et c√¶tera ‚Ä¶ &lt;- c'est des points de suspension, pas '...' </small>
				<p>exposer seulement la font ne suffit pas : il faut descendre au niveau du <em>glyphe</em> dessin√© par chaque navigateur</p>
			</section>
				
			<section>
				<h2>D√©mo avanc√©es</h2>
				<p>avec Chrome Canary, Safari Technology Preview ou Firefox Aurora</p>
				<p>https://css-houdini.rocks</p>
				<p>notamment : Inner Borders, Masonry, Random Bubble Masks</p>
			</section>

			<section>
				<h2>Pour suivre / plus loin</h2>
				<p>https://www.chromium.org/teams (r√©tros 'agiles')</p>
				<p>https://github.com/w3c/css-houdini-drafts/wiki/Meeting-Planning-Pages (meetings trimestriels CSSWG)</p>
				<p>https://houdini.glitch.me (d√©mos)</p>
				<p>2020, rapprochement de Paint API et Web Animations API :</p>
				<p>On peut imaginer un IDE en ligne 100% web, gratuit et open source qui remplacerait Sketch/Adobe XD, 100% extensible car bas√© sur des APIs ouvertes</p>
				<p>Plus de "on peut pas le faire en CSS" : mais √ßa va demander des comp√©tences de dessin canvas2D et animation... FullFullStack ?</p>
			</section>

				<!--
				<section>Recap blogs wk/chome</section>
				<section>pwa</section>
				<section>preload srcset</section>
				-->


				<style>
						.darkside_txt {
							color: white;
						}
						.darkside {
							background-image:url('anakin.png');
							background-size: contain;
							height:250px;
						}
						@media (prefers-color-scheme: dark) {
							body {
								background-color: black;
								color: white;
							}
							.darkside {
								background-image:url('vador.jpg');
							}
							.darkside_txt {
								color: red;
							}
						}
						</style>
						<section>
							<h2>Dark mode</h2>
							<p class="darkside_txt">iOS13, Android Q</p>
							<pre><code class="css" data-trim data-line-numbers="1">
	@media (prefers-color-scheme: dark) {
		body {
			background-color: black;
			color: white;
		}
		.darkside {
			background-image:url('vador.jpg')
		}
		}
								</code></pre>
								<p class="darkside"></p>
						</section>

				<section>EOF</section>

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
